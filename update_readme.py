# update_readme.py
# Уникальная метка: UPDATE_README_V1
# Дата и время запуска: 2025-05-30 06:34:00 EEST

import os
from git import Repo


def update_readme_with_output(readme_path, output_text):
    # Читаем текущий README.md
    with open(readme_path, 'r', encoding='utf-8') as f:
        current_content = f.read()

    # Новая секция с выводом
    new_section = (
            "\n## Split Files Preview\n"
            "Below is the output of the first 6 lines of each CSV file in the `split_files` folder, "
            "as generated by `display_split_files.py`:\n\n"
            "```\n" + output_text + "\n```"
    )

    # Добавляем новую секцию в конец файла
    updated_content = current_content + new_section

    # Сохраняем обновлённый README.md
    with open(readme_path, 'w', encoding='utf-8') as f:
        f.write(updated_content)
    print(f"Файл {readme_path} обновлён.")


def commit_and_push(repo_path, commit_message):
    try:
        # Инициализируем репозиторий
        repo = Repo(repo_path)

        # Добавляем README.md в индекс
        repo.git.add('README.md')

        # Создаём коммит
        repo.index.commit(commit_message)

        # Пушим изменения
        origin = repo.remote(name='origin')
        origin.push()
        print("Изменения успешно загружены в репозиторий.")
    except Exception as e:
        print(f"Ошибка при коммите или пуше: {e}")


if __name__ == "__main__":
    # Путь к проекту и README
    project_dir = r"C:\Users\Estal\PycharmProjects\ONNX_bot"
    readme_path = os.path.join(project_dir, "README.md")

    # Вывод display_split_files.py (взято из вашего лога)
    output_text = """=== Файл: XAUUSD_1 Min_Ask_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);Open;High;Low;Close;Volume
2020.01.02 01:00:00;1519,592;1521,245;1519,435;1520,385;0,01987
2020.01.02 01:01:00;1520,385;1520,825;1520,085;1520,805;0,00907
2020.01.02 01:02:00;1520,785;1520,795;1520,525;1520,695;0,00748
2020.01.02 01:03:00;1520,675;1520,765;1520,515;1520,765;0,00417
2020.01.02 01:04:00;1520,825;1521,175;1520,705;1520,985;0,0083

=== Файл: XAUUSD_1 Min_Bid_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);Open;High;Low;Close;Volume
2020.01.02 01:00:00;1518,768;1520,675;1518,768;1519,895;0,02014
2020.01.02 01:01:00;1519,875;1520,335;1519,595;1520,315;0,0088
2020.01.02 01:02:00;1520,285;1520,305;1520,035;1520,205;0,0064
2020.01.02 01:03:00;1520,185;1520,275;1520,015;1520,275;0,0039
2020.01.02 01:04:00;1520,325;1520,685;1520,195;1520,505;0,00767

=== Файл: XAUUSD_15 Mins_Ask_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);Open;High;Low;Close;Volume
2020.01.02 01:00:00;1519,592;1522,125;1519,435;1520,035;0,27121
2020.01.02 01:15:00;1520,005;1520,535;1519,435;1519,875;0,2354
2020.01.02 01:30:00;1519,875;1520,045;1519,035;1519,625;0,1529
2020.01.02 01:45:00;1519,675;1519,675;1518,332;1518,595;0,23903
2020.01.02 02:00:00;1518,605;1519,345;1518,305;1519,335;0,18843

=== Файл: XAUUSD_15 Mins_Bid_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);Open;High;Low;Close;Volume
2020.01.02 01:00:00;1518,768;1521,068;1518,768;1519,758;0,16901
2020.01.02 01:15:00;1519,758;1520,288;1519,168;1519,598;0,15515
2020.01.02 01:30:00;1519,588;1519,778;1518,768;1519,328;0,09993
2020.01.02 01:45:00;1519,328;1519,328;1518,075;1518,285;0,16123
2020.01.02 02:00:00;1518,305;1519,075;1518,008;1519,055;0,20106

=== Файл: XAUUSD_30 Mins_Ask_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);Open;High;Low;Close;Volume
2020.01.02 01:00:00;1519,592;1522,125;1519,435;1519,875;0,50661
2020.01.02 01:30:00;1519,875;1520,045;1518,332;1518,595;0,39193
2020.01.02 02:00:00;1518,605;1519,562;1518,305;1519,452;0,36151
2020.01.02 02:30:00;1519,452;1519,555;1518,392;1518,845;0,28734
2020.01.02 03:00:00;1518,845;1521,125;1517,392;1520,215;0,93533

=== Файл: XAUUSD_30 Mins_Bid_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);Open;High;Low;Close;Volume
2020.01.02 01:00:00;1518,768;1521,068;1518,768;1519,598;0,32416
2020.01.02 01:30:00;1519,588;1519,778;1518,075;1518,285;0,26116
2020.01.02 02:00:00;1518,305;1519,305;1518,008;1519,205;0,38702
2020.01.02 02:30:00;1519,185;1519,285;1518,3;1518,625;0,28455
2020.01.02 03:00:00;1518,605;1520,835;1517,115;1519,935;0,94009

=== Файл: XAUUSD_4 Hours_Ask_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);Open;High;Low;Close;Volume
2020.01.02 00:00:00;1519,592;1522,125;1517,392;1519,612;3,02429
2020.01.02 04:00:00;1519,612;1521,402;1518,612;1520,455;2,49515
2020.01.02 08:00:00;1520,492;1521,612;1518,652;1520,872;7,35696
2020.01.02 12:00:00;1520,925;1529;1519,895;1528,245;7,8053
2020.01.02 16:00:00;1528,245;1531,585;1522,992;1525,475;15,90298

=== Файл: XAUUSD_4 Hours_Bid_2020.01.01_2025.01_2025.05.25_trimmed.csv ===
Time (EET);Open;High;Low;Close;Volume
2020.01.02 00:00:00;1518,768;1521,068;1517,115;1519,365;2,66566
2020.01.02 04:00:00;1519,345;1521,135;1518,335;1520,185;2,44931
2020.01.02 08:00:00;1520,185;1521,375;1518,395;1520,625;7,70202
2020.01.02 12:00:00;1520,655;1528,978;1519,588;1527,998;8,09072
2020.01.02 16:00:00;1528,008;1531,328;1522,715;1525,208;16,93503

=== Файл: XAUUSD_5 Mins_Ask_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);Open;High;Low;Close;Volume
2020.01.02 01:00:00;1519,592;1521,245;1519,435;1520,985;0,04889
2020.01.02 01:05:00;1520,985;1522,125;1520,845;1521,262;0,05339
2020.01.02 01:10:00;1521,192;1521,192;1519,725;1520,035;0,16893
2020.01.02 01:15:00;1520,005;1520,535;1519,935;1520,155;0,07112
2020.01.02 01:20:00;1520,155;1520,155;1519,725;1519,745;0,07733

=== Файл: XAUUSD_5 Mins_Bid_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);Open;High;Low;Close;Volume
2020.01.02 01:00:00;1518,768;1520,685;1518,768;1520,505;0,04691
2020.01.02 01:05:00;1520,485;1521,068;1520,355;1520,838;0,02725
2020.01.02 01:10:00;1520,768;1520,768;1519,398;1519,758;0,09485
2020.01.02 01:15:00;1519,758;1520,288;1519,658;1519,868;0,04715
2020.01.02 01:20:00;1519,888;1519,888;1519,408;1519,458;0,05243

=== Файл: XAUUSD_Daily_Ask_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);Open;High;Low;Close;Volume
2020.01.02 00:00:00;1519,592;1531,585;1517,392;1529,785;40,93577
2020.01.03 00:00:00;1529,302;1553,762;1528,205;1552,805;70,20556
2020.01.06 00:00:00;1560;1587,915;1560;1566,195;79,72042
2020.01.07 00:00:00;1566,022;1577,602;1555,515;1574,945;62,95124
2020.01.08 00:00:00;1576,122;1611,732;1552,485;1557,365;114,16339

=== Файл: XAUUSD_Daily_Bid_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);Open;High;Low;Close;Volume
2020.01.02 00:00:00;1518,768;1531,328;1517,115;1528,825;44,51398
2020.01.03 00:00:00;1528,568;1553,515;1527,848;1551,515;73,18564
2020.01.06 00:00:00;1559,735;1585,625;1559,735;1565,445;73,68005
2020.01.07 00:00:00;1565,108;1577,248;1555,248;1573,945;70,30211
2020.01.08 00:00:00;1575,238;1611,325;1552,178;1556,095;110,24769

=== Файл: XAUUSD_Hourly_Ask_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);Open;High;Low;Close;Volume
2020.01.02 01:00:00;1519,592;1522,125;1518,332;1518,595;0,89854
2020.01.02 02:00:00;1518,605;1519,562;1518,305;1518,845;0,64885
2020.01.02 03:00:00;1518,845;1521,125;1517,392;1519,612;1,4769
2020.01.02 04:00:00;1519,612;1521,125;1518,612;1520,812;0,95109
2020.01.02 05:00:00;1520,835;1521,402;1520,012;1520,545;0,57998

=== Файл: XAUUSD_Hourly_Bid_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);Open;High;Low;Close;Volume
2020.01.02 01:00:00;1518,768;1521,068;1518,075;1518,285;0,58532
2020.01.02 02:00:00;1518,305;1519,305;1518,008;1518,625;0,67157
2020.01.02 03:00:00;1518,605;1520,835;1517,115;1519,365;1,40877
2020.01.02 04:00:00;1519,345;1520,855;1518,335;1520,555;0,95554
2020.01.02 05:00:00;1520,555;1521,135;1519,785;1520,275;0,58353

=== Файл: XAUUSD_Renko_ONE_PIP_Ticks_Ask_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);EndTime;Open;High;Low;Close;Volume;WickPrice;OppositeWickPrice
2019.12.31 23:59:57.988;2020.01.02 01:00:04.421;1518,01;1518,02;1518,01;1518,02;0,00037;;
2020.01.02 01:00:04.422;2020.01.02 01:00:04.423;1518,02;1518,03;1518,02;1518,03;0;;
2020.01.02 01:00:04.424;2020.01.02 01:00:04.425;1518,03;1518,04;1518,03;1518,04;0;;
2020.01.02 01:00:04.426;2020.01.02 01:00:04.427;1518,04;1518,05;1518,04;1518,05;0;;
2020.01.02 01:00:04.428;2020.01.02 01:00:04.429;1518,05;1518,06;1518,05;1518,06;0;;

=== Файл: XAUUSD_Renko_ONE_PIP_Ticks_Bid_2020.01.01_2025.05.25_trimmed.csv ===
Time (EET);EndTime;Open;High;Low;Close;Volume;WickPrice;OppositeWickPrice
2019.12.31 23:59:49.271;2020.01.02 01:00:04.367;1516,91;1516,92;1516,91;1516,92;0,00052;;
2020.01.02 01:00:04.368;2020.01.02 01:00:04.369;1516,92;1516,93;1516,92;1516,93;0;;
2020.01.02 01:00:04.370;2020.01.02 01:00:04.371;1516,93;1516,94;1516,93;1516,94;0;;
2020.01.02 01:00:04.372;2020.01.02 01:00:04.373;1516,94;1516,95;1516,94;1516,95;0;;
2020.01.02 01:00:04.374;2020.01.02 01:00:04.375;1516,95;1516,96;1516,95;1516,96;0;;

=== Файл: XAUUSD_Ticks_2024.01.01_2025.05.25_trimmed.csv ===
Time (EET);Ask;Bid;AskVolume;BidVolume
2024.01.02 01:00:00.312;2064,562;2062,598;0,00022;0,00022
2024.01.02 01:00:01.170;2064,805;2062,875;0,00045;0,00045
2024.01.02 01:00:01.321;2064,716;2062,875;0,00027;0,00045
2024.01.02 01:00:01.423;2064,565;2062,655;0,00045;0,00045
2024.01.02 01:00:01.524;2064,565;2062,714;0,00045;0,00027"""

    # Обновляем README
    update_readme_with_output(readme_path, output_text)

    # Коммитим и пушим изменения
    commit_message = "Added split_files preview to README.md"
    commit_and_push(project_dir, commit_message)